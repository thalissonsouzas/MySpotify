{"ast":null,"code":"import _regeneratorRuntime from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (c\\xF3pia)/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{addSong,getFavoriteSongs,removeSong}from'../services/favoriteSongsAPI';import Carregando from'./Carregando';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MusicsCard=/*#__PURE__*/function(_Component){_inherits(MusicsCard,_Component);var _super=_createSuper(MusicsCard);function MusicsCard(){var _this;_classCallCheck(this,MusicsCard);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={loading:false,favorite:false};_this.handleChecked=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var trackId,favoritesLocalStorage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:trackId=_this.props.trackId;_context.next=3;return getFavoriteSongs();case 3:favoritesLocalStorage=_context.sent;if(favoritesLocalStorage){_this.setState({favorite:favoritesLocalStorage.some(function(track){return track.trackId===trackId;})});}case 5:case\"end\":return _context.stop();}},_callee);}));_this.adicionarFavorito=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var _this$props,trackName,previewUrl,trackId,checked;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this$props=_this.props,trackName=_this$props.trackName,previewUrl=_this$props.previewUrl,trackId=_this$props.trackId;_this.setState({loading:true});checked=e.target.checked;if(!checked){_context2.next=8;break;}_context2.next=6;return addSong({trackName:trackName,previewUrl:previewUrl,trackId:trackId});case 6:_context2.next=10;break;case 8:_context2.next=10;return removeSong({trackName:trackName,previewUrl:previewUrl,trackId:trackId});case 10:_context2.next=12;return _this.handleChecked();case 12:_this.setState({loading:false});case 13:case\"end\":return _context2.stop();}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();return _this;}_createClass(MusicsCard,[{key:\"componentDidMount\",value:function componentDidMount(){this.handleChecked();}},{key:\"render\",value:function render(){var _this$props2=this.props,trackName=_this$props2.trackName,previewUrl=_this$props2.previewUrl,trackId=_this$props2.trackId;var _this$state=this.state,loading=_this$state.loading,favorite=_this$state.favorite;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:trackName}),/*#__PURE__*/_jsxs(\"audio\",{\"data-testid\":\"audio-component\",src:previewUrl,controls:true,children:[/*#__PURE__*/_jsx(\"track\",{kind:\"captions\"}),\"O seu navegador n\\xE3o suporta o elemento\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\".\"]}),loading?/*#__PURE__*/_jsx(Carregando,{}):/*#__PURE__*/_jsxs(\"label\",{\"data-testid\":\"checkbox-music-\".concat(trackId),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onChange:this.adicionarFavorito,checked:favorite}),\"Favorita\"]})]});}}]);return MusicsCard;}(Component);export{MusicsCard as default};","map":{"version":3,"names":["React","Component","addSong","getFavoriteSongs","removeSong","Carregando","MusicsCard","state","loading","favorite","handleChecked","trackId","props","favoritesLocalStorage","setState","some","track","adicionarFavorito","e","trackName","previewUrl","checked","target"],"sources":["/home/thalisson/trybe/projetos/frontend/sd-030-a-project-trybetunes (cópia)/src/components/MusicsCard.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { addSong, getFavoriteSongs, removeSong } from '../services/favoriteSongsAPI';\nimport Carregando from './Carregando';\n\nexport default class MusicsCard extends Component {\n  state = ({\n    loading: false,\n    favorite: false,\n  });\n\n  componentDidMount() {\n    this.handleChecked();\n  }\n\n  handleChecked = async () => {\n    const { trackId } = this.props;\n    const favoritesLocalStorage = await getFavoriteSongs();\n    if (favoritesLocalStorage) {\n      this.setState({ favorite: favoritesLocalStorage\n        .some((track) => track.trackId === trackId),\n      });\n    }\n  };\n\n  adicionarFavorito = async (e) => {\n    const { trackName, previewUrl, trackId } = this.props;\n    this.setState({ loading: true });\n    const { target: { checked } } = e;\n    if (checked) {\n      await addSong({ trackName, previewUrl, trackId });\n    } else {\n      await removeSong({ trackName, previewUrl, trackId });\n    }\n    await this.handleChecked();\n    this.setState({ loading: false });\n  };\n\n  render() {\n    const { trackName, previewUrl, trackId } = this.props;\n    const { loading, favorite } = this.state;\n\n    return (\n      <div>\n        <h3>{trackName}</h3>\n        <audio data-testid=\"audio-component\" src={ previewUrl } controls>\n          <track kind=\"captions\" />\n          O seu navegador não suporta o elemento\n          <code>audio</code>\n          .\n        </audio>\n        {loading ? <Carregando />\n          : (\n            <label data-testid={ `checkbox-music-${trackId}` }>\n              <input\n                type=\"checkbox\"\n                onChange={ this.adicionarFavorito }\n                checked={ favorite }\n              />\n              Favorita\n            </label>)}\n\n      </div>\n    );\n  }\n}\n\nMusicsCard.propTypes = {\n  trackName: PropTypes.string,\n  previewUrl: PropTypes.string,\n}.isRequired;\n"],"mappings":"w9BAAA,MAAOA,MAAK,EAAIC,SAAS,KAAQ,OAAO,CAExC,OAASC,OAAO,CAAEC,gBAAgB,CAAEC,UAAU,KAAQ,8BAA8B,CACpF,MAAOC,WAAU,KAAM,cAAc,CAAC,2FAEjBC,WAAU,2UAC7BC,KAAK,CAAI,CACPC,OAAO,CAAE,KAAK,CACdC,QAAQ,CAAE,KACZ,CAAC,OAMDC,aAAa,wEAAG,sKACNC,OAAO,CAAK,MAAKC,KAAK,CAAtBD,OAAO,uBACqBR,iBAAgB,EAAE,QAAhDU,qBAAqB,eAC3B,GAAIA,qBAAqB,CAAE,CACzB,MAAKC,QAAQ,CAAC,CAAEL,QAAQ,CAAEI,qBAAqB,CAC5CE,IAAI,CAAC,SAACC,KAAK,QAAKA,MAAK,CAACL,OAAO,GAAKA,OAAO,GAC5C,CAAC,CAAC,CACJ,CAAC,qDACF,SAEDM,iBAAiB,6FAAG,kBAAOC,CAAC,wLACiB,MAAKN,KAAK,CAA7CO,SAAS,aAATA,SAAS,CAAEC,UAAU,aAAVA,UAAU,CAAET,OAAO,aAAPA,OAAO,CACtC,MAAKG,QAAQ,CAAC,CAAEN,OAAO,CAAE,IAAK,CAAC,CAAC,CACda,OAAO,CAAOH,CAAC,CAAzBI,MAAM,CAAID,OAAO,KACrBA,OAAO,iDACHnB,QAAO,CAAC,CAAEiB,SAAS,CAATA,SAAS,CAAEC,UAAU,CAAVA,UAAU,CAAET,OAAO,CAAPA,OAAQ,CAAC,CAAC,+DAE3CP,WAAU,CAAC,CAAEe,SAAS,CAATA,SAAS,CAAEC,UAAU,CAAVA,UAAU,CAAET,OAAO,CAAPA,OAAQ,CAAC,CAAC,iCAEhD,OAAKD,aAAa,EAAE,SAC1B,MAAKI,QAAQ,CAAC,CAAEN,OAAO,CAAE,KAAM,CAAC,CAAC,CAAC,wDACnC,sIAzBD,4BAAoB,CAClB,IAAI,CAACE,aAAa,EAAE,CACtB,CAAC,sBAyBD,iBAAS,CACP,iBAA2C,IAAI,CAACE,KAAK,CAA7CO,SAAS,cAATA,SAAS,CAAEC,UAAU,cAAVA,UAAU,CAAET,OAAO,cAAPA,OAAO,CACtC,gBAA8B,IAAI,CAACJ,KAAK,CAAhCC,OAAO,aAAPA,OAAO,CAAEC,QAAQ,aAARA,QAAQ,CAEzB,mBACE,oCACE,oBAAKU,SAAS,EAAM,cACpB,eAAO,cAAY,iBAAiB,CAAC,GAAG,CAAGC,UAAY,CAAC,QAAQ,6BAC9D,cAAO,IAAI,CAAC,UAAU,EAAG,4CAEzB,oCAAM,OAAK,EAAO,IAEpB,GAAQ,CACPZ,OAAO,cAAG,KAAC,UAAU,IAAG,cAErB,eAAO,uCAAgCG,OAAO,CAAI,wBAChD,cACE,IAAI,CAAC,UAAU,CACf,QAAQ,CAAG,IAAI,CAACM,iBAAmB,CACnC,OAAO,CAAGR,QAAU,EACpB,WAEJ,GAAS,GAET,CAEV,CAAC,wBA3DqCR,SAAS,SAA5BK,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}